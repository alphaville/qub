<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <!--
  Copyright 2019 Pantelis Sopasakis

  This work is licensed under the Attribution 4.0 International CC licence 
  (see https://creativecommons.org/licenses/by/4.0/)

  You are free to:
    Share — copy and redistribute the material in any medium or format
    Adapt — remix, transform, and build upon the material
    for any purpose, even commercially.

  The licensor cannot revoke these freedoms as long as you follow the license terms.

  Under the following terms:
    Attribution — You must give appropriate credit, provide a link to the license, 
    and indicate if changes were made. You may do so in any reasonable manner, but 
    not in any way that suggests the licensor endorses you or your use.

    No additional restrictions — You may not apply legal terms or technological measures
     that legally restrict others from doing anything the license permits.

  Notices:
    You do not have to comply with the license for elements of the material in the public 
    domain or where your use is permitted by an applicable exception or limitation.

    No warranties are given. The license may not give you all of the permissions necessary 
    for your intended use. For example, other rights such as publicity, privacy, or moral 
    rights may limit how you use the material.

  -->

  <title>OCL Ensembles - P. Sopasakis</title>

  <meta name="viewport" content="width=device-width">

  <link rel="stylesheet" href="../lib/js/reveal/css/reveal.css"> <!-- we must first load reveal.js -->
  <link rel="stylesheet" href="../lib/css/presentation.css">
  <link rel="stylesheet" href="../lib/js/reveal/lib/css/zenburn.css">
  <link rel="stylesheet" href="../lib/css/include_fonts.css">


  <!-- Printing and PDF exports -->
  <!-- usage: add "?print-pdf" to URL, e.g. ".../index.html?print-pdf" -->
  <script>
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? 'lib/js/reveal/css/print/pdf.css' : 'lib/js/reveal/css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>


</head>

<body>
  <div class="reveal">
    <div class="slides">

      <section>
        <div style="margin-top: 2em"> </div>
        <h1>Optimisation, Control and Learning Ensembles</h1>
        <h2>for Safe Intelligent Cobots</h2>
        <div style="margin-top: 2em;text-align:center;">
          <a href="https://alphaville.github.io" target="blank" style="color:black; text-decoration: none">
            <span class="bold">Pantelis Sopasakis</span>
          </a>
        </div>
        <div style="margin-top: 0.35em; text-align:center; font-size: 0.9em">Queen's University Belfast</div>
      </section>


      <!-- 
        
        CHALLENGES
      -->
      <section data-background=var(--my_blue) data-state="plain-slide">
        <div style="margin-top: 10%; font-size:2.6em; text-align: center; color: white">
          Challenges &amp; Objectives
        </div>
        <div style="margin-top: 10%; font-size:1em; text-align: center; color: white">
          Safe Intelligent Cobots
        </div>
      </section>


      <section>
        <h2>
          Challenges
        </h2>
        <div style="text-align: center; margin-top: 5em">
          <img src="../img/challenges.png" alt="challenges" width="900" />
        </div>
      </section>

      <section>
        <h2>Objectives</h2>
        <table style="width:100%; margin-top: 1.0em">
          <tr>
            <td style="vertical-align: middle">
              <img src="../img/roboto.gif" alt="mr_roboto" style="width: 120pt" />
            </td>
            <td style="vertical-align: middle">
              <img src="../img/objectives.png" width="750" />
            </td>
          </tr>
        </table>
      </section>


      <section>
        <h2>Vision</h2>
        <div class="centered" style="margin-top: 6%">
          <img src="../img/pyramid.png" width="800" />
        </div>
      </section>

      <!-- 
        
        LEARNING-BASED CONTROL
      -->
      <section data-background=var(--my_blue) data-state="plain-slide">
        <div style="margin-top: 10%; font-size:2.6em; text-align: center; color: white">
          Learning-based Control
        </div>
        <div style="margin-top: 10%; font-size:1em; text-align: center; color: white">
          Risk-averse Model Predictive Control
        </div>
      </section>

      <section>
        <h2>Model Predictive Control</h2>
        <div style="text-align: center; margin-top: 1em">
          <video id="mpc-video" data-autoplay width="930" autoplay loop>
            <source src="../mov/MPC/mpc.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="footnote">
          J.B. Rawlings, D.Q. Mayne &amp; M. Diehl,
          <span class="italix">Model Predictive Control: Theory, Computation, and Design</span>,
          Nob Hill Pub., 2009.
        </div>
      </section>

      <section>
        <h2>Certainty-Equivalent Control</h2>
        <div class="fragment replace" data-fragment-index="1">
          <img src="../img/ce-ctrl-1.png" alt="textbook" style="width: 100%" />
        </div>
        <div class="fragment replace" data-fragment-index="1">
          <img src="../img/ce-ctrl-2.png" alt="textbook" style="width: 100%" />
        </div>
      </section>

      <section>
        <h2>Worst-case Control</h2>
        <div class="fragment replace" data-fragment-index="1">
          <img src="../img/wc-ctrl-1.png" alt="worst case control" style="width: 100%" />
        </div>
        <div class="fragment replace" data-fragment-index="1">
          <img src="../img/wc-ctrl-1.png" alt="worst case control" style="width: 100%; opacity: 0.1;" />
          <div id="wc-mpc" style="position: absolute; top: 30%">
            <div>Worst-case MPC:</div>
            <div id="wp-mpc-formulation" class="block-equation" style="margin-left: 3em">
              $$
              \operatorname*{Minimise}_{u_0,\ldots,u_{N-1}} \operatorname*{max}_{(w_0,\ldots, w_{N-1})\in W} \left[
              \ell_N(x_N) +
              \sum_{t=0}^{N-1} \ell_t(x_t,
              u_t, w_t)\right]
              $$
            </div> <!-- END of #wp-mpc-formulation -->
            <div>subject to system dynamics, $x_{t+1}=f(x_t, u_t, w_t)$, and constraints.</div>
          </div> <!-- END of #wc-mpc -->
        </div>
        <div class="fragment replace" data-fragment-index="3">
          <img src="../img/wc-ctrl-2.png" alt="textbook" style="width: 100%" />
        </div>
      </section>

      <section>
        <h2>Stochastic Control</h2>
        <div class="fragment replace" data-fragment-index="1">
          <img src="../img/stoch-ctrl-1.png" alt="textbook" style="width: 100%" />
        </div>
        <div class="fragment replace" data-fragment-index="1">
          <img src="../img/stoch-ctrl-1.png" alt="textbook" style="width: 100%; opacity: 0.1;" />
          <div id="stoch-mpc" style="position: absolute; top: 20%">
            <div>Stochastic MPC:</div>
            <div id="stoch-mpc-formulation" class="block-equation" style="margin-left: 3em">
              $$
              \operatorname*{Minimise}_{u_0,\ldots,u_{N-1}} \mathbb{E}_{w_0,\ldots, w_{N-1}} \left[
              \ell_N(x_N) +
              \sum_{t=0}^{N-1} \ell_t(x_t,
              u_t, w_t)\right]
              $$
            </div> <!-- END of #wp-mpc-formulation -->
            <div>subject to the system dynamics and constraints.</div>
          </div> <!-- END of #wc-mpc -->
        </div>
        <div class="fragment replace" data-fragment-index="3">
          <img src="../img/stoch-ctrl-2.png" alt="textbook" style="width: 100%" />
        </div>
        <div class="fragment replace centered" data-fragment-index="4" style="margin-top: 2em">
          <img src="../img/counterexample.jpg" alt="counterexample" width="80%" />
        </div>
      </section>

      <section>
        <h2>Uncertainty in uncertainty</h2>
        <div style="text-align: center; margin-top: 0.2em">
          <video data-autoplay width="930" autoplay loop>
            <source src="../mov/STOCHASTIC/pmf.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="footnote">
          P. Sopasakis, M. Schuurmans and P. Patrinos, "Safe learning-based risk-averse MPC," IEEE Conf. Decision and
          Control, Nice, 2019.
        </div>
      </section>


      <section>
        <h2>Measuring Risk</h2>
        <div class="sub-header-separator"></div>
        <div>
          <div class="fragment replace" data-fragment-index="1" style="text-align: center">
            <img src="../img/stochastic-case.jpg" alt="stochastic case" width="400" />
            <img src="../img/wc-case.jpg" alt="worst case" width="400" />
          </div>
          <div class="fragment replace" data-fragment-index="1" style="text-align: center">
            <img src="../img/stochastic-case.jpg" alt="stochastic case" width="220" />
            <img src="../img/risk-case.jpg" alt="risk case" width="460" />
            <img src="../img/wc-case.jpg" alt="worst case" width="220" />
          </div>
        </div>

        <div class="footnote">
          P. Sopasakis, D. Herceg, A. Bemporad and P. Patrinos,
          "Risk-averse model predictive control,"
          Automatica 100, pp. 281-288, Feb. 2019.
        </div>
      </section>

      <section>
        <section>
          <h2>Measuring Risk</h2>
          <div style="text-align: center">
            <img src="../img/stochastic-case.jpg" alt="stochastic case" width="220" style="opacity: 0.1" />
            <img src="../img/risk-case.jpg" alt="risk case" width="460" style="opacity: 0.1" />
            <img src="../img/wc-case.jpg" alt="worst case" width="220" style="opacity: 0.1" />
          </div>
          <div style="position: absolute; top: 35%">
            A <span class="bold">risk measure</span> maps a random cost, $Z$, to a value, $\rho(Z)$,
            with
            <div class="block-equation">
              $$
              \mathbb{E}[Z] {}\leq{} \rho(Z) {}\leq{} \max[Z]
              $$
            </div>
            Well-behaving (<span class="bold">coherent</span>) risk measures:
            <div class="block-equation">
              $$
              \rho(Z) {}={} \max_{\mu\in\mathcal{A}}\mathbb{E}_\mu[Z]
              $$
            </div>
            where $\mathcal{A}$ (closed and convex) is called the <span class="bold">ambiguity set</span>
            of $\rho$.
          </div>
        </section>
        <section>
          <h2>Trivial risk measures</h2>
          <div class="sub-header-separator"></div>
          <div>
            Let $\Omega$ be a finite sample space, $\Omega = \{\omega_1,\ldots, \omega_K\}$,
            which is equipped with a probability vector $p \in \mathbb{R}^K$ (suppose $p_i>0$).
          </div>
          <div class="sub-header-separator"></div>
          <div>
            The <span class="bold">expectation</span> and the <span class="bold">maximum</span> are
            coherent risk measures.
          </div>
          <div class="sub-header-separator"></div>
          <div>
            The ambiguity set of the exectation is the singleton $\{p\}$ and the
            ambiguity set of the maximum is the probability simplex,
          </div>
          <div class="block-equation">
            $$D_K = \{\mu \in \mathbb{R}^K {}:{} \sum_i \mu_i = 1, 0 \leq \mu_i\}$$
          </div>
        </section>
        <section>
          <h2>Average value-at-risk</h2>
          <div class="sub-header-separator"></div>
          <div>
            A popular risk measure is the <span class="bold">average value-at-risk</span> with parameter
            $\alpha\in(0,1]$
            given by
            <div class="block-equation">
              $$
              \mathrm{AV@R}_{\alpha}[Z] = \inf_{t\in\mathbb{R}} t + \tfrac{1}{\alpha}\mathbb{E}\max\{0, Z-t\}
              $$
            </div>
            <div>
              The ambiguity set of $\mathrm{AV@R}_{\alpha}$ is the set
            </div>
            <div class="block-equation">
              $$
              \mathcal{A}_\alpha = \{\mu \in D_K {}:{} \mu_i \leq
              \tfrac{1}{\alpha}p_i \}
              $$
            </div>
          </div>
        </section>
      </section>

      <section>
        <h2>Risk-averse MPC</h2>
        <div class="sub-header-separator"></div>
        First attempt:
        <div class="block-equation">
          $$
          \operatorname*{Minimise}_{u_0,\ldots, u_{N-1}}\rho_{w_0,\ldots, w_{N-1}}
          \bigg[
          \ell_N(x_N) {}+{} \sum_{t=0}^{N-1} \ell_t(x_t,u_t, w_t)
          \bigg]
          $$
        </div>
        <div>
          subject to the system dynamics and constraints.
        </div>
        <div class="sub-header-separator"></div>
        <div>
          However,
          <div class="half-separator"></div>
          <ul>
            <li>$\rho_{w_0,\ldots, w_{N-1}}$ does not measure how the uncertainty propagates</li>
            <li>Dynamic programming does not apply</li>
            <li>We cannot derive stability conditions</li>
          </ul>
        </div>


        <div class="footnote">
          P. Sopasakis, D. Herceg, A. Bemporad and P. Patrinos,
          "Risk-averse model predictive control,"
          Automatica 100, pp. 281-288, Feb. 2019.
        </div>
      </section>


      <section>
        <h2>Risk-averse MPC</h2>
        <div class="sub-header-separator"></div>
        <div>
          Proper multistage formulation:
          <div class="block-equation">
            $$
            \operatorname*{Minimise}_{u_0,\ldots, u_{N-1}}\rho_{w_0}
            \Big[
            \ell_0(x_0,u_0, w_0)
            {}+{}
            \rho_{w_1\mid w_0}\left[\ell_1(x_1,u_1, w_1) {}+{} \ldots{} \right]
            \Big]
            $$
          </div>
          <div>
            subject to the system dynamics and constraints.
          </div>
        </div>
        <div class="footnote">
          P. Sopasakis, D. Herceg, A. Bemporad and P. Patrinos,
          "Risk-averse model predictive control,"
          Automatica 100, pp. 281-288, Feb. 2019.
        </div>
      </section>



      <section>
        <h2>Risk-averse MPC: Consequences</h2>

        <div style="text-align: center; margin-top: 2em">
          <div style="position: absolute">
            A novel <span class="bold">safe</span> control framework which
            becomes increasingly <span class="bold">less conservative</span> as more data become available.
          </div>
          <div id="concept-video">
            <video data-autoplay width="670" autoplay loop>
              <source src="../mov/STOCHASTIC/concept.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div>
            It allows to create an <span class="bold">unexplored synergy</span>
            of <span class="bold">control and learning</span>!
          </div>
        </div>


        <div class="footnote">
          P. Sopasakis, D. Herceg, A. Bemporad and P. Patrinos,
          "Risk-averse model predictive control,"
          Automatica 100, pp. 281-288, Feb. 2019.
        </div>
      </section>

      <!-- 
        
        NUM. OPTIMISATION
        PART-I: NONCONVEX
      -->
      <section data-background=var(--my_blue) data-state="plain-slide">
        <div style="margin-top: 10%; font-size:2.6em; text-align: center; color: white">
          Numerical Optimisation
        </div>
        <div style="margin-top: 3em; font-size:1em; text-align: center; color: white">
          Collision Avoidance
        </div>
      </section>


      <section>
        <h2>Collision avoidance</h2>
        <div style="margin-top: 10%"></div>
        <div id="oa-images" class="centered">
          <div class="fragment replace" data-fragment-index="1">
            <img src="../img/oa1.png" width=30% />
            <img src="../img/oa2.png" width=30% />
            <img src="../img/oa3.png" width=30% />
          </div>
          <div class="fragment replace" data-fragment-index="1">
            <div style="position: absolute; text-align: left; top: 40%">The dynamics is always <span class="bold">nonlinear</span></div>
            <div style="position: absolute; text-align: left; top: 50%">
              The constraints are always <span class="bold">nonconvex</span>
            </div>
            <img src="../img/oa1.png" width=30% style="opacity: 0.1" />
            <img src="../img/oa2.png" width=30% style="opacity: 0.1" />
            <img src="../img/oa3.png" width=30% style="opacity: 0.1" />
          </div>
        </div>

      </section>

      <section data-background-image="../img/mc.jpeg" data-background-size="cover" data-background-opacity="var(--bck_opacity)">
        <h2>Embedded Nonconvex Optimisation</h2>
        <div style="margin-top: 3em"></div>
        <!-- <div>Facts...</div> -->
        <div style="margin-top: 1.2em"></div>
        <div><span class="bold">SQP</span> and <span class="bold">IP</span> involve complex steps (QP solution, linear
          systems)</div>
        <div style="margin-top: 1.2em"></div>
        <div>They are not suitable for embedded applications</div>
        <div style="margin-top: 1.2em"></div>
        <div>Projected gradient (PG) is simple,</div>
        <div class="block-equation">
          $$u^{\nu+1} = \Pi_{U}(u^\nu - \gamma \nabla f(u^\nu))$$
        </div>
        <div>but very slow!</div>
      </section>

      <section data-background-image="../img/mc.jpeg" data-background-size="cover" data-background-opacity="var(--bck_opacity)">
        <h2>Embedded Nonconvex Optimisation</h2>
        <div style="margin-top: 2.3em"></div>
        <div id="first-idea-container">
          <div id="first-idea-text">
            <span class="bold">IDEA #1.</span> An averaged algorithm that takes convex combinations of
            <span style="color: green">safe</span> (PG)
            and <span style="color: red">fast</span> (Quasi-Newtonian) steps!
          </div>
          <div class="block-equation">
            $u^{\nu+1} = u^{\nu} + \tau_\nu$
            <span style="color: red">$d_{\mathrm{LBFGS}}^{\nu}$</span>
            ${}+{} (1-\tau_\nu)[$<span style="color: green">$u^\nu - T_\gamma(u^\nu)$</span><span>$]$</span>
          </div>
        </div>
        <div style="margin-top: 3em"></div>
        <div id="second-idea-container" class="fragment" data-fragment-index="1">
          <div class="sub-header-separator"></div>
          <div id="second-idea-text">
            <span class="bold">IDEA #2.</span> A <span class="bold">globalisation</span> of the above
            algorithm using a real-valued continuous merit function - the forward-backward envelope.
          </div>
        </div>
        <div class="footnote">
          L. Stella, A. Themelis, P. Sopasakis and P. Patrinos,
          <span class="italix">et al.</span>, "A simple and efficient algorithm for nonlinear model predictive
          control," IEEE CDC, 2017.
        </div>
      </section>


      <section data-background-image="../img/mc.jpeg" data-background-size="cover" data-background-opacity="var(--bck_opacity)">
        <h2>Forward-Backward Envelope</h2>
        <div class="sub-header-separator"></div>
        <div class="centered">
          <img src="../img/fbe.png" width="630" />
        </div>
        <div class="footnote">
          L. Stella, A. Themelis, P. Sopasakis and P. Patrinos,
          <span class="italix">et al.</span>, "A simple and efficient algorithm for nonlinear model predictive
          control," IEEE CDC, 2017.
        </div>
      </section>

      <section data-background-image="../img/mc.jpeg" data-background-size="cover" data-background-opacity="var(--bck_opacity)">
        <h2>Two Orders of Magnitude Faster!</h2>
        <div class="sub-header-separator"></div>
        <div class="centered">
          <img src="../img/two-orders.png" width="630" />
        </div>
        <div class="footnote">
          AS Sathya, P Sopasakis, <span class="italix">et al.</span>
          <span class="italix">et al.</span>, "Embedded nonlinear model predictive control for obstacle avoidance using
          PANOC,"
          IEEE ECC, 2018.
        </div>
      </section>

      <section data-background-video="../mov/MAV/mav-nmpc.mp4" data-background-video-loop="loop" data-background-size="cover"
        data-background-video-muted="true">
        <div class="footnote" style="color: rgba(255, 255, 255, 0.63)">
          E. Small, P. Sopasakis, <span class="italix">et al.</span>, "Aerial navigation in obstructed environments
          with embedded nonlinear model predictive control," IEEE ECC, 2019.
        </div>
      </section>


      <!-- 
        
        NUM. OPTIMISATION
        PART-II: LARGE-SCALE
      -->
      <section data-background-image="../img/gpu.jpeg" data-background-size="cover" data-background-opacity="var(--bck_opacity)">
        <h2>Large-scale GPU-accelerated optimisation</h2>
        <div class="sub-header-separator"></div>
        <div class="centered">
          <img src="../img/gpu_algorithms.png" width="930" />
        </div>
      </section>


      <!-- 
        
        MY RESEARCH VISION
      -->
      <section data-background=var(--my_blue) data-state="plain-slide">
        <div style="margin-top: 10%; font-size:2.6em; text-align: center; color: white">
          My Research Vision
        </div>
      </section>

      <section>
        <h2>Safe Intelligent Cobotics</h2>
        <div class="sub-header-separator"></div>
        <div class="centered">
          <img src="../img/vision.png" width="930" />
        </div>
      </section>

      <section>
        <h2>Educational value</h2>
        <div style="text-align: center; margin-top: 5%">
          <img src="../img/book.png" alt="textbook" style="width: 90pt" />
          <img src="../img/book.png" alt="textbook" style="width: 90pt" />
        </div>

        <div style="vertical-align: middle; text-align: center;  margin-top: 5%">
          <div><span class="bold">Elegant</span> OCL framework</div>
          <div style="margin:0.5em">$\Downarrow$</div>
          <div>Two textbooks</div>
        </div>
      </section>

      <section>
        <h2>Research Team</h2>
        <table style="width:100%; vertical-align: middle; margin-top: 3em">
          <tr>
            <td style="vertical-align: middle">
              Funding agencies...
              <br />
              <br />
              <img src="../img/epsrc.png" alt="EPSRC" style="width: 140pt" />
              <img src="../img/h2020.jpeg" alt="EPSRC" style="width: 140pt" />
              <br />
              <br />
              <img src="../img/leverhulme.jpeg" alt="EPSRC" style="width: 140pt" />
              <img src="../img/rae.jpeg" alt="EPSRC" style="width: 140pt" />

            </td>
            <td style="vertical-align: middle; text-align: center">
              <div id="two-phd-students">
                <img src="../img/study.jpeg" alt="PhD student" style="width: 100pt" />
                <img id="flipped_phd" src="../img/study.jpeg" alt="PhD student" style="width: 100pt" />
              </div>
              <div>
                Two PhD students
              </div>
              <div style="margin-top: 0.7em; margin-bottom: 0.7em">+</div>
              <div><img src="../img/student_cap.png" alt="Postdoc" style="width: 100pt" /></div>
              <div>
                One postdoc
              </div>
            </td>
          </tr>
        </table>
      </section>


      <section>
        <h2>Collaborations</h2>
        <div class="sub-header-separator"></div>
        <div style="text-align: center">
          <img src="../img/collaborators.png" alt="collaborators" width="930" />
        </div>

      </section>


      <!-- 

        THANK YOU
      -->
      <section>
        <h2>Thank you for your attention</h2>
        <div style="margin-top: 0em; right:0; position: absolute">
          <img id="flipped_roboto" src="../img/roboto.gif" alt="mr_roboto flipped" style="width: 120pt" />
        </div>
      </section>

      <!-- END OF PRESENTATION -->

      <!-- Reveal.js and Template Options -->
      <script src="../lib/js/reveal/lib/js/head.min.js"></script>
      <script src="../lib/js/reveal/js/reveal.js"></script>
      <script>
        Reveal.initialize({
          history: true,
          transition: 'none', // none/fade/slide/convex/concave/zoom
          transitionSpeed: 'fast', // default/fast/slow
          controls: true,
          center: false,
          touch: true,
          slideNumber: false,
          maxScale: 10.0,

          math: {
            mathjax: '../lib/js/mathjax/MathJax.js',
            config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
          },

          dependencies: [
            { src: '../lib/js/reveal/lib/js/classList.js' },
            { src: '../lib/js/reveal/plugin/math/math.js', async: true },
            { src: '../lib/js/reveal/plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
            { src: '../lib/js/reveal/plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
            { src: '../lib/js/reveal/plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
          ]
        });
      </script>

      <script>
        var vid = document.getElementById("mpc-video");
        vid.playbackRate = 2.5;
      </script>
    </div>
  </div>
</body>

</html>